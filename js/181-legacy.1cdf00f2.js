"use strict";(self["webpackChunkhello_world"]=self["webpackChunkhello_world"]||[]).push([[181],{2617:function(t,e,r){r.d(e,{Z:function(){return o}});var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"mb-3"},[r("h1",[t._v("餐廳後台")]),r("router-link",{attrs:{to:{name:"admin-restaurants"}}},[t._v("Restaurants")]),t._v(" | "),r("router-link",{attrs:{to:{name:"admin-categories"}}},[t._v("Categories")]),t._v(" | "),r("router-link",{attrs:{to:{name:"admin-users"}}},[t._v("Users")])],1)},a=[],s=r(1001),i={},u=(0,s.Z)(i,n,a,!1,null,null,null),o=u.exports},7719:function(t,e,r){r.r(e),r.d(e,{default:function(){return p}});var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container py-5"},[r("admin-nav"),r("table",{staticClass:"table"},[t._m(0),r("tbody",t._l(t.users,(function(e){return r("tr",{key:e.id},[r("th",{attrs:{scope:"row"}},[t._v(t._s(e.id))]),r("td",{staticStyle:{width:"60%"}},[t._v(t._s(e.email))]),r("td",{staticStyle:{width:"20%"}},[e.isAdmin?[t._v("admin")]:[t._v("user")]],2),r("td",[e.isAdmin?r("button",{staticClass:"btn btn-link",attrs:{type:"button",disabled:1===e.id},on:{click:function(r){return r.preventDefault(),r.stopPropagation(),t.toggleIsAdmin(e.id,e.isAdmin)}}},[t._v(" set as user ")]):r("button",{staticClass:"btn btn-link",attrs:{type:"button"},on:{click:function(r){return r.preventDefault(),r.stopPropagation(),t.toggleIsAdmin(e.id,e.isAdmin)}}},[t._v(" set as admin ")])])])})),0)])],1)},a=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("thead",{staticClass:"thead-dark"},[r("tr",[r("th",{attrs:{scope:"col"}},[t._v("#")]),r("th",{attrs:{scope:"col"}},[t._v("Email")]),r("th",{attrs:{scope:"col"}},[t._v("Role")]),r("th",{attrs:{scope:"col",width:"140"}},[t._v("Action")])])])}],s=r(3019),i=r(6198),u=(r(5666),r(1703),r(1539),r(9714),r(1249),r(2617)),o=r(9032),c=r(1926),l=r(629),d={name:"admin-users",components:{"admin-nav":u.Z},data:function(){return{users:[]}},created:function(){this.fetchUsers()},methods:{fetchUsers:function(){var t=this;return(0,i.Z)(regeneratorRuntime.mark((function e(){var r,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.Z.users.get();case 3:if(r=e.sent,n=r.data,a=r.statusText,"OK"===a){e.next=8;break}throw new Error(a);case 8:t.users=n.users,e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](0),c.F.fire({icon:"error",title:"無法取得用戶列表，請稍後再試"}),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})))()},toggleIsAdmin:function(t,e){var r=this;return(0,i.Z)(regeneratorRuntime.mark((function n(){var a,i,u;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,a=!e,n.next=4,o.Z.users.toggleUserRole({userId:t,isAdmin:a.toString()});case 4:if(i=n.sent,u=i.data,"success"===u.status){n.next=8;break}throw new Error(u.message);case 8:r.users=r.users.map((function(e){return e.id===t?(0,s.Z)((0,s.Z)({},e),{},{isAdmin:!e.isAdmin}):e})),n.next=15;break;case 11:n.prev=11,n.t0=n["catch"](0),c.F.fire({icon:"error",title:"無法更新用戶權限，請稍後再試"}),console.log(n.t0);case 15:case"end":return n.stop()}}),n,null,[[0,11]])})))()}},computed:(0,s.Z)({},(0,l.rn)(["currentUser"]))},m=d,f=r(1001),v=(0,f.Z)(m,n,a,!1,null,null,null),p=v.exports},1249:function(t,e,r){var n=r(2109),a=r(2092).map,s=r(1194),i=s("map");n({target:"Array",proto:!0,forced:!i},{map:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}})},9032:function(t,e,r){r(8309);var n=r(1926);e["Z"]={users:{get:function(){return n.l.get("/admin/users")},toggleUserRole:function(t){var e=t.userId,r=t.isAdmin;return n.l.put("admin/users/".concat(e),{isAdmin:r})}},categories:{get:function(){return n.l.get("/admin/categories")},create:function(t){var e=t.name;return n.l.post("/admin/categories",{name:e})},delete:function(t){var e=t.categoryId;return n.l["delete"]("/admin/categories/".concat(e))},update:function(t){var e=t.categoryId,r=t.name;return n.l.put("/admin/categories/".concat(e),{name:r})}},restaurants:{get:function(){return n.l.get("/admin/restaurants")},create:function(t){var e=t.formData;return n.l.post("/admin/restaurants",e)},delete:function(t){var e=t.restaurantId;return n.l["delete"]("/admin/restaurants/".concat(e))},getDetail:function(t){var e=t.restaurantId;return n.l.get("/admin/restaurants/".concat(e))},update:function(t){var e=t.restaurantId,r=t.formData;return n.l.put("/admin/restaurants/".concat(e),r)}}}}}]);
//# sourceMappingURL=181-legacy.1cdf00f2.js.map